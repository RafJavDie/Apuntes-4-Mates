\documentclass[a4paper,12pt]{article}
\usepackage{makeidx}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amscd,amsthm}
\usepackage{amssymb}
\usepackage{tabularx}
\usepackage{amssymb,eucal,bezier,graphicx}
\usepackage{times,amssymb}
\usepackage[ansinew]{inputenc}
\usepackage{multicol}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{verbatim}
\usepackage{tikz-cd}
\usetikzlibrary{graphs}
\usetikzlibrary{arrows.meta}
\usepackage{listings}


\newtheorem{thm}{Theorem}[section]
\newtheorem{coro}[thm]{Corolario}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{prob}[thm]{Problema}
\newtheorem{defi}[thm]{Definición}
\newtheorem{conj}[thm]{Conjectura}
\newtheorem{nota}[thm]{Nota}
\newtheorem{ejem}[thm]{Ejemplo}
\providecommand{\gilb}[1]{\mathcal{G}_{#1}}
\providecommand{\abs}[1]{\left|{#1}\right|}
\newcommand{\Pri}{\mathbb{P}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newtheorem{demo}[thm]{Demostración}
\providecommand{\gabs}[1]{\left|{#1}\right|}
\begin{document}

%%Los tres siguientes comandos estaban inicialmente desinsertados, pero no funcionaban en concordancia en el texto

\renewcommand{\figurename}{Figure}

\renewcommand\thefigure{\arabic{section}.\arabic{figure}} 

\numberwithin{figure}{section} 

\renewcommand\refname{Bibliografia}


\begin{center} {\large \bf Estudio de la Conjetura de Gilbreath}
\end{center}

\begin{center}
{\bf Eleazar Duarte Aponte, Rafael González López,\\
Rocío Palacios Cantillo, Luis Palma Blanco,\\
Diego Pedraza López, María de los Remedio Boza Ruíz}
\end{center}

\begin{center}
\small{ Teoría Analítica de Números \\
\small Universidad de Sevilla. }
\end{center}

\vspace{0.4cm}

\begin{center}
{\bf Abstract}

\end{center}

\begin{quotation}
\noindent En este trabajo vamos a TAL TAL TAL
\end{quotation}

\vspace{0.1cm}



\section*{Introducción}
Durante el año 1958, Norman Gilbreath buscaba, como muchos otros matemáticos a lo largo de la historia, una forma de generar los primos. Para ello comenzó a estudiar las diferencias entre primos consecutivos. Si volvemos a repetir las diferencias en valor absoluto una y otra vez sobre la sucesión que nos queda, obtenemos algo de esta forma
$$
\begin{array}{c c c c c}
2 & 3 & 5 & 7 & 11\\
\hline
1 & 2 & 2 & 4 &\\
1 & 0 &  2 &  &\\
1 & 2 & & & \\
1 &   &  & & 
\end{array}
$$
Si denotamos $d^k_n$ al $n$-ésimo elemento de la $k$-ésima fila, entonces tenemos que
\begin{gather*}
d^1_n = p_{n+1}-p_n\\
d^k_n = \abs{d_{n+1}^{k-1}-d_{n}^{k-1}}
\end{gather*}
Gilbreath observó que la primera columna de la tabla era siempre el número uno, o en otra palabras, $d^k_1 = 1$ $\forall k \geq 1$. Aunque nunca ha llegado a demostrarse, Andrew Odlyzko comprobó la conjetura hasta $k=10^{13}$ en 1993 \cite{odly}.
\section{Preliminares}


\section{Estudio computacional de la conjetura de Gilbreath}
Utilizando una idea semejante a la que proporciona Odlyzko en \cite{odly}, programamos en C++ un algoritmo que nos permita comprobar experimentalmente la conjetura.

La idea se basa en la siguiente observación.
\begin{lemma}
Para todo $k$ tal que $d^k_1=1$ y existe $m$ tal que $d^k_n \in \{0,2\}$ para todo $1<n \leq m$, entonces $d^{k+j}_1=1$ para todo $1<j \leq m$.
\end{lemma}
\begin{demo}
Basta observar que $d^{k+1}_1=1$ y $d^{k+1}_n \in \{0,2\}$ para todo $1<n \leq m-1$, pues cada $d^{k+1}_n$ es el valor absoluto de la diferencia de números en $\{0,2\}$. Aplicando esto $m$ veces se demuestra el lema.
\end{demo}

Por lo tanto, podemos comprobar la conjetura eficientemente buscando filas que, tras el primer $1$, estén formadas por $0$ y $2$. Nuestra comprobación se basa en que la fila $645$ de la tabla tiene esta propiedad hasta una cantidad que aún no hemos encontrado. Este método tiene además la ventaja de que se puede implementar con uso de memoria constante, pues sólo necesitamos guardar en cada paso $645$ números y deshechar los $645$ números del paso anterior. Estos números se corresponden a la diagonal $d^{k+i}_{645-i}$ con $i=0,\dots,644$. Por simplifación, hemos computado previamente la primera diagonal que necesitamos.

Para generar los números primos, hemos usado la librería primesieve \cite{primesieve}. El algoritmo es realmente eficiente, pues en un simple ordenador portátil permite comprobar la conjetura hasta $10^9$. Creemos que con un ordenador más potente podría superarse en poco tiempo la comprobación que Odlyzko hizo en $1993$, especialmente si tuviera una tarjeta gráfica de última generación y adaptando el código para CUDASieve \cite{cudasieve} en lugar de primesieve.

\lstset{
	language=C++,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\ttfamily,
    stringstyle=\color{red}\ttfamily,
    commentstyle=\color{green}\ttfamily,
    morecomment=[l][\color{magenta}]{\#}
    numberstyle=\ttfamily\tiny\color[gray]{0.2},
    numbers=left,
    backgroundcolor=\color{gray!10},
    frame=single,
    tabsize=2,
    rulecolor=\color{black!30},
    title=\lstname,
    escapeinside={\%*}{*)},
    breaklines=true,
    breakatwhitespace=true,
    framextopmargin=2pt,
    framexbottommargin=2pt
}
\begin{lstlisting}
#include <primesieve.hpp>
#include <iostream>
#include <vector>

// Número de pasos máximo
static const long P = pow(10,9);

// Comprueba la conjetura de Gilbreath hasta 10^9
// usando ideas de Odlyzko
int main () {
	// Diagonal 645:
	std::vector<uint64_t> nums 
	{4703,12,0,6,4,2,0,2,0,0,2,2,0,4,2,0,0,2,2,2,0,0,
	0,2,0,0,0,2,0,2,2,2,2,2,0,0,0,2,0,0,0,2,0,2,2,2,2,
	0,0,2,2,0,0,0,0,0,0,2,2,2,2,2,0,0,2,2,0,0,2,0,0,2,
	2,2,0,0,2,0,0,0,2,2,2,2,0,0,2,0,2,0,0,0,0,2,0,0,2,
	0,0,0,2,2,2,2,0,2,2,2,2,0,2,2,2,0,2,2,2,2,2,2,2,0,
	0,2,2,2,2,0,0,2,2,2,2,2,2,2,0,0,0,2,2,0,2,0,2,2,2,
	0,2,0,2,0,0,2,0,0,0,2,0,0,2,2,2,2,2,0,0,0,0,2,2,0,
	0,2,0,2,0,2,2,2,2,0,2,0,2,0,0,0,2,0,2,2,0,0,0,0,2,
	2,2,0,2,0,2,2,2,2,0,0,2,0,2,0,0,2,0,0,0,0,0,0,2,0,
	2,2,2,2,2,2,2,2,0,2,2,0,0,0,2,2,0,0,2,0,0,2,0,2,0,
	0,0,0,2,0,2,2,0,0,2,0,2,2,0,0,2,2,2,0,2,0,2,2,0,2,
	2,0,2,2,2,2,2,2,0,0,2,2,2,0,0,0,2,0,2,0,0,2,2,2,2,
	0,0,2,2,2,0,0,2,2,0,0,0,2,2,2,0,0,0,2,0,2,2,2,0,2,
	0,0,2,0,0,2,0,0,2,0,0,0,2,0,0,2,0,2,0,0,2,0,0,0,2,
	0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,2,0,
	2,2,2,2,2,0,2,0,0,2,0,0,0,0,2,0,0,2,0,0,0,2,2,2,2,
	2,2,0,2,0,0,0,0,0,2,2,0,2,2,0,2,2,0,2,0,0,2,0,0,0,
	2,2,2,2,0,2,0,0,0,2,2,2,2,2,2,0,2,2,2,2,2,2,0,2,2,
	0,2,2,0,0,0,2,2,0,0,2,0,2,2,0,0,0,0,2,2,0,0,0,2,0,
	0,2,2,0,0,2,0,2,2,0,2,0,0,0,0,0,2,0,2,0,0,0,2,0,2,
	0,2,0,2,0,2,2,2,0,0,2,0,0,0,0,2,0,0,0,0,0,2,0,2,0,
	0,0,0,0,2,2,2,0,2,0,0,2,2,0,2,0,0,0,0,0,0,0,0,2,2,
	2,2,2,2,2,2,0,0,0,2,2,2,0,2,2,0,0,0,2,0,2,2,0,2,2,
	0,2,2,0,2,0,0,2,2,2,2,0,0,0,0,2,0,0,0,2,2,0,2,0,0,
	0,2,0,2,2,2,2,0,2,2,0,2,0,0,0,0,0,0,0,2,2,2,2,0,0,
	0,2,2,0,2,2,0,2,2,0,0,0,1};

uint64_t nexto;
primesieve::iterator it;
it.skipto(4704);
uint64_t tempo;
for (long p = 0; p < P; ++p) {
	nexto = it.next_prime();
	
	for (int i = 0; i < 635; ++i) {
		tempo = abs(nexto-nums[i]);
		nums[i] = nexto;
		nexto = tempo;
	}
	
	// Con un poco de loop unrolling 
	//es más eficiente
	for (int i = 0; i < 634; ++i) {
		tempo = abs(nexto-nums[i]);
		nums[i] = nexto;
		nexto = tempo;
	}
		
	if (nums[634] != 0 && nums[634] != 2) {
		std::cout << "Contraejemplo en Paso"
		<< p << ":" << nums[634] << std::endl;
		return 0;
	}
}
std::cout << "Conjetura cierta hasta " << P << '.' << std::endl;
}
\end{lstlisting}

Para tener una representación gráfica del triángulo que se forma al calcular los sucesivos $d_n$, hemos implementado el siguiente código en Haskell 

\lstset{
  frame=none,
  xleftmargin=2pt,
  stepnumber=1,
  numbers=left,
  numbersep=4pt,
  numberstyle=\ttfamily\tiny\color[gray]{0.2},
  belowcaptionskip=\bigskipamount,
  captionpos=b,
  escapeinside={*'}{'*},
  language=haskell,
  tabsize=1,
  emphstyle={\bf},
  commentstyle=\it,
  stringstyle=\mdseries\rmfamily,
  showspaces=false,
  keywordstyle=\bfseries\rmfamily,
  columns=flexible,
  basicstyle=\small\sffamily,
  showstringspaces=false,
  morecomment=[l]\%,
}
\small{
\begin{lstlisting}
import Data.Numbers.Primes
import Data.List

-- Introducimos una lista de n números que nos sirve como sucesión numérica.
-- En este caso, vamos a tomar la lista de los 10^24 primeros primos
suc :: [Int]
suc = take (10^24) primes

-- Construimos la función que nos dé la lista en la siguiente etapa
fun :: [Int] -> [Int]
fun xs = zipWith (\x y -> abs (x-y)) xs (tail xs)

-- Lista infinita de listas infinitas de la pirámide de Gilbreath
gilbreath_seq :: [[Int]]
gilbreath_seq = iterate fun primes

-- Comprueba la conjetura de Gilbreath para hasta n primos
conjetura :: Int -> Bool
conjetura n = all (==1) . take n . tail . map head $ gilbreath_seq

triangulo :: Int -> [[Int]]
triangulo n = [take (n-i) xs | (i,xs) <- zip [0..] (take n gilbreath_seq)]

dibujaTriangulo :: Int -> IO ()
dibujaTriangulo n = mapM_ putStrLn $ map (unwords . map show) a
	where a = take n (triangulo n)
\end{lstlisting}}
Mostramos una salida del código para hacernos una idea de cómo funciona el código

\begin{lstlisting}
*Main> dibujaTriangulo 12
2 3 5 7 11 13 17 19 23 29 31 37
1 2 2 4 2 4 2 4 6 2 6
1 0 2 2 2 2 2 2 4 4
1 2 0 0 0 0 0 2 0
1 2 0 0 0 0 2 2
1 2 0 0 0 2 0
1 2 0 0 2 2
1 2 0 2 0
1 2 2 2
1 0 0
1 0
1
\end{lstlisting}

\section{Árbol de Gilbreath}

Consideremos todas las sucesiones crecientes $\{a_n\}_{n\in I}$ tales que $a_1=2$, $a_2=3$, $a_n$ es impar y mayor que $3$ para todo $n$. Si no hay confusión sobre la sucesión de la que estamos hablando, notaremos 
\begin{gather*}
d^1_n = a_{n+1}-a_n\\
d^k_n = \abs{d_{n+1}^{k-1}-d_{n}^{k-1}}
\end{gather*}
Normalmente $I=\N$ o $I=\N_k$.
\begin{defi}
En las condiciones anteriores, diremos que $\{a_n\}_{n\in I}$ es una sucesión de Gilbreath si $d^k_1 =1$ para todo $k\in I$.
\end{defi}
Una consecuencia trivial de esta definición es que
\begin{prop}
La conjetura de Gilbreath es equivalente a que $\{p_n\}$ sea una sucesión de Gilbreath. 
\end{prop}
\subsection{Crecimiento y distribución}
\begin{defi}
Sea $S=\{a_n\}_{n\in\N_k}$ una sucesión finita de Gilbreath. Definimos $\mathcal{G}_S$ como el conjunto de todos los elementos tales que si $m\in \mathcal{G}_S$ entonces la sucesión definida como $b_n = a_n$ si $n\leq k$ y $b_{k+1}=m$ sigue siendo una sucesión de Gilbreath.
\end{defi}
\begin{ejem}Vamos a ilustrar estos conceptos con algunos ejemplos. 
\begin{enumerate}
\item Si $S=\{2,3\}$ entonces $\gilb{S}=\{5\}$. 
\item Si $S=\{2,3,5,7\}$ entonces $\gilb{S}=\{9,11\}$. 
\item Si $S=\{2,3,5,9\}$ entonces $\gilb{S}=\{11,13,15,17\}$.
\item Si $S=\{2,3,5,7,11\}$ entonces $\gilb{S} = \{13,15,17,19,21\}$.
\end{enumerate}
\end{ejem}
\begin{defi}
Generalizando el concepto, diremos que $\{a_n\}_{i\in I}$ es mayor que $\{b_n\}_{i\in I}$ si $a_i \geq b_i$ para todo $i\in I$.
\end{defi}
\begin{prop}
El conjunto de las sucesioens de Gilbreath con el orden anterior tiene un mínimo y un máximo. De hecho,  la sucesión $\{m_n\}_{n\in \N}$ la menor sucesión de Gilbreath y $\{M_n\}_{n\in \N}$ la mayor sucesión de Gilbreate, entonces
\begin{itemize}
\item $\{m_n\}_{n\in \N}$ es la sucesión $m_1 = 2$, $m_n = 2n-1$  $\forall n\geq 2$.
\item $\{M_n\}_{n\in \N}$ es la sucesión $M_n = 2^{n-1}+1$ $\forall  n\geq 1$.
\end{itemize}
\end{prop}
\begin{demo}
Como las sucesiones de Gilbreath están formadas por impares para $n\geq 2$ y son crecientes, si $\{m_n\}$ es una sucesión de Gilbreath, entonces ha de ser forzosamente la menor. Pero esto es evidente pues $d^1_1 = 1$ y $d_n^1 = 2$ $\forall n \geq 2$, por tanto $d^2_1 = 1$ y $d^2_n = 0$ $\forall n \geq 2$, de donde se tiene trivialmente que $d^k_1 = 1$ $\forall k \geq 1$.

Veamos primero que $\{M_n\}$ es una sucesión de Gilbreath. Claramente 
\begin{align*}
d_1^1 &= a_2 - a_1 = 3-2 =1 = 2^0\\
d_n^1 &= 2^n+1-2^{n-1}-1 = 2^{n-1}(2-1) = 2^{n-1} \quad n\geq 2\\
d_n^2 &= 2^n - 2^{n-1} = 2^{n-1}
\end{align*}
Por inducción se tiene que, $\forall n,k$ $d_n^k = 2^{n-1}$. Por tanto, $d_1^k = 1$ $\forall k\geq 1$. Vamos a probar que es la mayor por reducción al absurdo. Supongamos que existe otra sucesión $\{\zeta_n\}$ que es mayor que $\{M_n\}$ haciéndose esa desigualdad estricta por primera vez en el $p$-ésimo término. En tal caso, $\zeta_p = 2^{p-1}+1+s$ con $s\geq 2$ par. Entonces
\begin{align*}
d_n^1 &= 2^{n-1} \quad n\leq p-2\\
d_{p-1}^1 &= 2^n+1+s-2^{n-1}-1 = 2^{n-1}(2-1) = 2^{n-1}+s 
\end{align*}
Por inducción llegamos a que $d^k_{p-k} = 2^{p-k-1}+s$, por lo que $d^{p-1}_1 = 2^0 +s = 1+s >1$.
\end{demo}
\begin{conj}
Sea $S$ una sucesión finita de Gilbreath con índice hasta $m$. Entonces
$$ s_m + 2 \in \mathcal{G}_S $$
\end{conj}
\begin{conj}
Sea $S$ una sucesión finita de Gilbreath con 3 o más términos y sea $2n+1$ su último término. Entonces $\exists m \in \N$, $m\geq n+1$ tal que 
$$\gilb{S} = \{2s+1\mid s \in \N,\; n+1\leq s \leq m\}$$
Es decir, $\gilb{S}$ es un conjunto de impares consecutivos. 
\end{conj}
\begin{prop}
Sean $\{m_n\}$ la menor sucesión de Gilbreath en el sentido de la Proposición $3.6$. Entonces si $n\geq 3$
$$
\gilb{m_n} = \{2n+1,2n+3\}$$
\end{prop}
\begin{demo}
Solo podemos dar una demostración para el primer apartado. Por la construcción $m_n$, sabemos que ${2n+1}\in\gilb{m_n}$. Si tomamos como siguiente término $2n+3$ es fácil ver, a partir de las consideraciones hechas en la Demostración 3.7, que la última diagonal será de la forma $d_n^1=4$ y $d_{n-i+1}^i=2$ si $2\leq i \leq n-1$, por lo que $d_1^n = |1-2| = 1$.

Análogamente, si el último término es $2n+3+2k$ con $k>0$ entonces $d_n^1 = 4+2k$, $d_{n-i+1}^i=2(k+1)$ si $2\leq i \leq n-1$, luego $d_n^1 = 1+2k>1$.
\end{demo}
\begin{conj}
Sean $\{M_n\}$ la mayor sucesión de Gilbreath en el sentido de la Proposición $3.6$. Entonces si $n\geq 3$
$$
 \gilb{M_n} = \{2^{n-1}+1+2k \mid 1\leq k \leq 2^{n-2}\}
$$
\end{conj}
\begin{nota}
Si las Conjeturas 3.8 y 3.10 son ciertas, el resultado se tendría de manera trivial.
\end{nota}
\begin{defi}
Sea $S_k=\{p_n\}_{n\in \N_k}$ la sucesión finita de los primeros $k$ primos. Definimos la sucesión $\{Q_n\}_{n\in\N}$ como $Q_1=2$, $Q_2=3$, y $Q_k=\max \gilb{S_k}$. 
Los primero valores de la sucesión son 
\begin{align*} \{Q_n\}=\{&2,3,5,9,11,21,21,27,27,33,41,51,55,57,53,63,67,89,85,95,105,97,\\
&109,105,121,129,137,129,135,137,155,\dotsc\}
\end{align*}
\end{defi}
\begin{coro}
Si la Conjetura 3.10 es cierta entonces la conjetura del Gilbreath es equivalente a que $Q_n \geq p_n$ para todo $n\in \N$.
\end{coro}
\begin{demo}
Si la conjetura de Gilbreath es cierta entonces se sigue trivialmente el resultado. Recíprocamente, supongamos que $Q_n \geq p_n$. Como $p_{n+1} \geq p_n+2$ entonces usando la Conjetura 3.10 tenemos que $p_{n+1} \in \mathcal{G}_{S_k}$ $\forall n$, luego $\{p_n\}$ es una sucesión de Gilbreath.
\end{demo}
Si analizamos la sucesión ${\{Q_n-p_n\}}$ obtenemos estos primeros 30 valores:
\begin{align*} \{Q_n-p_n\}=\{&0,0,0,2,0,8,4,8,4,4,10,14,14,14,6,10,8,28,18,24,32,18,26,16,\\
&24,28,34,22,26,24,\dotsc\}
\end{align*}
Es decir, en principio, parece que el \textit{gap} no solo se mantiene constantemente positivo sino que aumenta. Además, de un estudio premilinar conjeturamos lo siguiente
\begin{conj}
Sea $p_n$ un primo tal que $p_{n-1}=p_n-2$. Entonces existen infinitos $n$ tales que, si $p_n$ es de esa forma, $Q_{n+1}\leq Q_n$.  
\end{conj}
\begin{nota}
Hemos comprobado computacionalmente el resultado hasta $n=100$ y solo no se verifica en con dos primos gemelos. Además, $Q_n$ también decrece en otros valores no relacionados con los primos gemelos.
\end{nota}
\begin{nota}
Esta propiedad no parece ser algo intrínseco a los primos gemelos. En los casos estudiados, definiendo análogamente la sucesión $Q_n$ para una sucesión de Gilbreath cualquiera, parecen tener un comportamiento similar cuando $a_n = a_{n-1}+2$ suele decrecer igual que ocurre con los primos gemelos.
\end{nota}
\subsection{Estudio probabilístico}


\newpage


\begin{thebibliography}{99}

\bibitem{primesieve} Walisch, K. (2010-2018). Primesieve (Versión 6.4). Disponible en \url{http://primesieve.org/}

\bibitem{cudasieve} Seizert, C. (2016). CUDASieve. Disponible en \url{https://github.com/curtisseizert/CUDASieve/}

\bibitem{odly}  Odlyzko, A. (1993). Iterated Absolute Values of Differences of Consecutive Primes. Mathematics of Computation, 61(203), 373-380. doi:10.2307/2152962

\bibitem{rguy}  Kenneth Guy, R. (1993). Iterated Absolute Values of Differences of Consecutive Primes. Mathematics of Computation, 61(203), 373-380. doi:10.2307/2152962

\end{thebibliography}

\end{document}
