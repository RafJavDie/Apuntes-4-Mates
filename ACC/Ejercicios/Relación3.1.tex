\documentclass[twoside]{article}
\usepackage{../../estilo-ejercicios}

%--------------------------------------------------------
\begin{document}

\title{Ejercicios de Ideals, Varieties, and Algorithms (4ª Edición)}
\author{Diego Pedraza López, Javier Aguilar Martín, Rafael González López}
\maketitle
\begin{ejercicio}{3.1.1}
Let $I\subset k[x_1,\dotsc,x_n]$ be an ideal.
\begin{enumerate}[a.]
\item Prove that $I_l = I\cap k[x_{l+1},\dotsc,x_n]$ is an ideal of $k[x_{l+1},\dotsc,x_n]$.
\item Prove that ideal $I_{l+1} \subset k[x_{l+2},\dotsc,x_n]$ is the first elimination ideal $I_l \subset k[x_{l+1},\dotsc,x_n]$. This observation allows to use the Extension Theorem multiple times when eliminating more than one variable.
\end{enumerate}
\end{ejercicio}
\begin{solucion}
\begin{enumerate}[a.]
\item[]
\item Probemos que es un ideal
\begin{itemize}
\item Claramente $I_l \subset k[x_{l+1},\dotsc,x_n]$.
\item Si $f,g\in I_l$, entonces solo tienen términos en $x_{l+1},\dotsc,x_n$, luego la suma tendrá solo esos términos. Como $f+g\in I$ y $f+g\in k[x_{l+1},\dotsc,x_n]$ tenemos que $f+g\in I_l$.
\item Tomando $a\in k[x_{l+1},\dotsc,x_n]$ y $f \in I_l$, entonces $af$ solo tiene términos en $x_{l+1},\dotsc,x_n$, luego el producto tendrá solo esos términos. Se deduce, como en el apartado anterior, que $af\in I_l$.
\end{itemize}
\item Es inmediato si renombramos los índices de las variables y consideramos $I'=I_{l+1}$ que $I_1'=I_{l+1}$.
\end{enumerate}
\end{solucion}

\newpage

\begin{ejercicio}{3.1.2}
Consider the system of equations
\begin{align*}
x^2+2y^2&=3\\
x^2+xy+y^2&=3
\end{align*}
\begin{enumerate}[a.]
\item If $I$ is the ideal generated by these equations, find bases of $I ∩ k[x]$ and $I ∩ k[y]$.
\item Find all solutions of the equations.
\item Which of the solutions are rational, i.e., lie in $\Q^2$?
\item What is the smallest field $k$ containing $\Q$ such that all solutions lie in $k^2$?
\end{enumerate}
\end{ejercicio}
\begin{solucion}
\begin{enumerate}[a.]
\item[]
\item Consideremos $I=\gene{x^2+2y^2-3,x^2+xy+y^2-3}$. Claramente este ideal es igual a
$$
I=\gene{x^2+2y^2-3,xy-y^2}
$$
Calculamos una base de Gröbner para lex con $x>y$.
$$
S(f_1,f_2) = -y^2x + 2y^3-3y   = yf_2 + 3y^3-3y 
$$
Luego añadimos $y^3-y$ a nuestra base. Como $S(f_1,f_2)$ va a tener ahora resto 0, $LT(f_1)$ y $LT(f_3)$ son coprimos, solo tenemos que comprobar
$$
S(f_2,f_3) = xy - y^4 = f_2  -yf_3
$$
Por tanto, $G=\{f_1,f_2,f_3\}$ es una base de Gröbner y por el Teorema 2 
$$I\cap k[y] = \gene{y^3-y}$$
Análogamente, calculamos una base de Gröbner para $y>x$ y obtenemos
$$
\{2y^2 + x^2 - 3, -2yx - x^2 + 3, -x^4 + 2x^2 - 3, -y^2 + yx, 6y +3x^3 - 9x\}
$$
Por lo que 
$$
I\cap k[x] = \{-x^4+2x^2-3\}
$$
\item Es claro que mejor eliminar $y$. Obtenemos $y(y^2-1)=0$, por lo que $y=0$ e $y=\pm 1$. Sustituimos en las otras 2 y obtenemos
$$
x^2 - 3 = 0 \qquad x^2-1 = x-1 = 0 \qquad x^2 -1 = -x +1 = 0
$$
De donde obtenemos las soluciones $(\pm \sqrt{3},0),(1,1),(-1,-1)$.
\item Tan solo está en $\Q^2$ las soluciones $(1,1)$ y $(-1,-1)$.
\item $k=\Q(\sqrt{3}) = \{a+b\sqrt{3}\mid a,b\in \Q\}$.
\end{enumerate}
\end{solucion}


\newpage

\begin{ejercicio}{3.1.3}
Determine all solutions $(x, y) ∈ \Q^2$ of the system of equations
\begin{align*}
x^2+2y^2&=2\\
x^2+xy+y^2&=2
\end{align*}
Also determine all solutions in $\C^2$.
\end{ejercicio}
\begin{solucion}
Procediendo análogamente al ejercicio anterior, calculamos una base de Gröbner del ideal generado y obtenemos
$$
G=\{x^2 + 2y^2 - 2, xy - y^2, 3y^3 - 2y\}
$$
Por tanto, $y(3y^2-2) =0$, de donde sacamos $y=0$ e $y=\pm \sqrt{2/3}$. Por tanto, tenemos los sistemas
$$
x^2 = 2 \qquad x^2 + \frac{4}{3}  = x^2 + x\sqrt{\frac{2}{3}}+\frac{2}{3} = 2 \qquad x^2 + \frac{4}{3} = x^2 - x\sqrt{\frac{2}{3}}+\frac{2}{3} = 2
$$
De donde obtenemos  $(\pm \sqrt{2},0)$ por la primera ecuación, $(\sqrt{2/3},\sqrt{2/3})$ por la segunda y $(-\sqrt{2/3},-\sqrt{2/3})$ para la tercera. Por tanto no hay ninguna racional. En $\C^2$ son las mismas soluciones que hemos obtenido. 
\end{solucion}


\newpage

\begin{ejercicio}{3.1.4}
Find bases for the elimination ideals $I_1$ and $I_2$ for the ideal $I$ determined by the equations:
\begin{align*}
x^2+y^2+z^2&=4\\
x^2+2y^2&=5\\
xz & = 1
\end{align*}
How many rational (i.e., in $\Q^3$) solutions are there?
\end{ejercicio}
\begin{solucion}
Si calculamos una base de Gröbner obtenemos
$$ G=\{x + 2z^3 - 3z, y^2 - z^2 - 1, 2z^4 - 3z^2 + 1\}$$
Esto implica que $G_2=\{2z^4 - 3z^2 + 1\}$ y $G_1=G_2\cup \{y^2 - z^2 - 1\}$. Resolvemos la tercera y obtenemos $z=\pm 1$ y $z=\pm 1/\sqrt{2}$ y sustituimos en las otras dos obteniendo

\begin{gather*}
x=1 \quad y = \pm\sqrt{2} \qquad x= -1 \quad y = \pm\sqrt{2}\\
x=\sqrt{2} \quad y=\pm \sqrt{\frac{3}{2}} \qquad x = -\sqrt{2} \quad y=\pm\sqrt{\frac{3}{2}} 
\end{gather*}
\end{solucion}


\newpage

\begin{ejercicio}{3.1.5}
In this exercise, we will prove a more general version of the Elimination Theorem. Fix an integer $1\leq l \leq n$. We say that a monomial order $>$ on $k[x_1,\dotsc, x_n]$ is of $l$-elimination type provided that any monomial involving one of $x_1,\dotsc, x_l$ is greater than all monomials in $k[x_{l+1}, \dotsc, x_n]$. Prove the following generalized Elimination Theorem. If I is an ideal in $k[x_1,\dotsc, x_n]$ and $G$ is a  Gröbner basis of $I$ with respect a monomial order of $l$-elimination type, then $G_l = G\cap k[x_l,\dotsc, x_n]$ is a Gröbner basis of the $l$-th elimination ideal $I_l = I\cap k[x_{l+1},\dotsc, x_n]$.
\end{ejercicio}
\begin{solucion}
Análogamente a la prueba del Teorema 2, tenemos que ver que $$\gene{LT(I_l)}\subset \gene{LT(G_l)}$$
Sea $f\in I_l$, sabemos que $\exists g \in G$ tal que $LT(g)\mid LT(f)$ por definición de base de Gröbner. Ahora bien, si $LT(g)\mid LT(f)$, ya que $LT(f)$ es un monomio en $x_{l+1},\dotsc,x_n$, entonces $LT(g)$ también lo es. Por definición de  orden de tipo $l$-eliminador tenemos que el resto de monomios de $g$, si los hubiera, también serían en las mismas variables. Por tanto, $g\in G_l$.
\end{solucion}


\newpage

\begin{ejercicio}{3.1.6}
To exploit the generalized Elimination Theorem of Exercise 5, we need some interesting examples of monomial orders of $l$-elimination type. We will consider two such orders.
\begin{enumerate}[a.]
\item Fix an integer $1\leq l \leq n$, and define the order $>_l$ as follows: if $\alpha,\beta \in \Z_{\geq 0}^n$, then $\alpha>_l\beta$ if
$$
\alpha_1 + \dotsc + a_l > \beta_1 + \dotsc + \beta_l \text{ or } \alpha_1 + \dotsc + a_l = \beta_1 + \dotsc + \beta_l \text{ and } \alpha >_{grevlex} \beta
$$
This is the $l$-th elimination order of BAYER and STILLMAN (1987b). Prove that $>l$ is a monomial order and is of $l$-elimination type. Hint: If you did Exercise 11 of Chapter 2,
§4, then you have already done this problem.
\item In Exercise 9 of Chapter 2, §4, we considered an example of a product order that mixed lex and grlex orders on different sets of variables. Explain how to create a product order that induces grevlex on both $k[x_{1},\dotsc, x_n]$ and $k[x_{l+1},\dotsc, x_n]$ and show that this order
is of l-elimination type.
\item If $G$ is a Gröbner basis for $I ⊆ k[x_1, . . . , x_n]$ for either of the monomial orders of parts (a) or (b), explain why $G ∩ k[x_{l+1}, . . . , x_n]$ is a Gröbner basis with respect to grevlex.
\end{enumerate}
\end{ejercicio}
\begin{solucion}
\begin{enumerate}[a.]
\item[]
\item En efecto, la prueba del Ejercicio 2.4.11 garantiza que este es un orden monomial tomando $u$ cuyas $l$ primeras comopenentes son $1$ y el resto de $0$, y $>_\sigma$ como $>_{grevlex}$. Es inmediato que este orden es de tipo $l$-eliminatorio, pues si $x^\alpha$ tiene algún monomio en $x_1,\dotsc,x_l$ y $x^\beta$, entonces $\exists i$, $1\leq i \leq l$ tal que $\alpha_i >0$ y no existe ninguno tal que $\beta_i >0$, por lo que 
$$
a_1 + \dotsc + \alpha_l > 0 = \beta_1 + \dotsc + \beta_l
$$
\item Lo natural parece ser tomar, si denotamos por $x$ al vector de las primeras $l$ componentes e $y$ al resto, de manera que cada monomio puede escribirse como $x^\alpha y^\beta$ con $\alpha\in \Z^l_{\geq0}$ y $\beta \in \Z_{\geq 0}^{n-l}$, definir el orden $>^*$ como
$$
x^\alpha y^\beta >^* x^\gamma y^\delta \Leftrightarrow x^\alpha >_{grevlex} x^\gamma \text{ or } x^\alpha = x^\beta >_{grevlex} x^\gamma
$$
Es trivial que es de tipo $l$-eliminatorio pues si un monomio no tiene elementos de $x_1,\dotsc,x_l$ podemos escribirlo como $x^0y^\gamma$, luego por ser orden monomial, cualquier monomio que tenga términos en $x_1,\dotsc,x_l$ verificará que $x^\alpha >_{grevlex}x^0$.
\item Por el ejercicio anterior sabemos que podemos aplicar el Teorema de la Eliminación. El resultado se desprende del hecho de que podemos identificar un monomio $x^0 y^\beta \in k[x_1,\dotsc,x_n]$ con un monomio $y^\beta \in k[x_{l+1},\dotsc,x_n]$, pues para cualesquiera órdenes $>$ de (a) o (b):
$$
x^0y^\beta > x^0y^\gamma \Leftrightarrow y^\beta >_{grevlex} y^\gamma
$$
\end{enumerate}
\end{solucion}


\newpage

\begin{ejercicio}{3.1.7}
Consider the equations
\begin{align*}
t^2 + x^2 + y^2 + z^2 &= 0\\
t^2 + 2x^2 − xy − z^2 &= 0\\
t + y^3 − z^3 &= 0
\end{align*}
We want to eliminate $t$. Let $I = 
\gene{t^2 + x^2 + y^2 + z^2, t^2 + 2x^2 − xy − z^2, t + y^3 − z^3}$ be the
corresponding ideal.
\begin{enumerate}[a.]
\item Using lex order with $t > x > y > z$, compute a Gröbner basis for $I$, and then find a basis
for $I ∩ \Q[x, y, z]$. You should get four generators, one of which has total degree 12.
\item Compute a grevlex Gröbner basis for $I ∩ \Q[x, y, z]$. You will get a simpler set of two
generators.
\item Combine the answer to part (b) with the polynomial $t + y^3 − z^3$ and show that this
gives a Gröbner basis for $I$ with respect to the elimination order $>1$ (this is $>l$ with
$l = 1$) of Exercise \ref{ejer:3.1.6}. Note that this Gröbner basis is much simpler than the one found
in part (a). If you have access to a computer algebra system that knows elimination
orders, then check your answer.
\end{enumerate}
\end{ejercicio}
\begin{solucion}
\begin{enumerate}[a.]
\item[]
\item Usando SAGE obtenemos la base de Gröbner para $I$. La base tiene unos polinomios enormes, así que escribo directamente los que no tienen variable $t$
\begin{align*}
G\cap \Q[x,y,z] = \{&y^{13} - 4y^{10}z^3 + 5y^9 + 6y^7z^6 + 6y^7z^2 - 10y^6z^3 + 5y^5 - 4y^4z^9 - 12y^4z^5\\ &+
 5y^3z^6 + 13y^3z^2 + yz^{12} + 6yz^8 + 9yz^4,\\
&-2y^{12} + 8y^9z^3 - 10y^8 - 12y^6z^6 - 12y^6z^2 + 20y^5z^3 - 10y^4 + 8y^3z^9\\
&+ 24y^3z^5 - 10y^2z^6 - 26y^2z^2 - 2z^{12} - 12z^8 - 18z^4\}
\end{align*}
\item De manera absolutamente maravillosa obtenemos
$$
G\cap \Q[x,y,z] = \{-x^2 + xy + y^2 + 2z^2\}
$$
\end{enumerate}
\end{solucion}


\newpage

\begin{ejercicio}{3.1.8}
In equation (6), we showed that $z \neq 0$ could be specified arbitrarily. Hence, $z$ can be
regarded as a “parameter.” To emphasize this point, show that there are formulas for $x$ and
$y$ in terms of $z$. Hint: Use $g_1$ and the quadratic formula to get $y$ in terms of $z$. Then use $xyz =
1$ to get $x$. The formulas you obtain give a “parametrization” of $\V(I)$ which is different
from those studied in §3 of Chapter 1. Namely, in Chapter 1, we used parametrizations by rational functions, whereas here, we have what is called a parametrization by algebraic
functions. Note that $x$ and $y$ are not uniquely determined by $z$.
\end{ejercicio}
\begin{solucion}
Tenemos la ecuación de $g_1$
\[
y^4z^2 + y^2(z^4 − z^2) + 1=0
\]
Fijando $z$ como parámetro podemos despejar $y^2$
\[
y^2=\frac{z^2-z^4\pm\sqrt{(z^4-z^2)^2-4z^2}}{2z^2}\Rightarrow y=\pm\sqrt{\frac{z^2-z^4\pm\sqrt{(z^4-z^2)^2-4z^2}}{2z^2}}
\]
Por último de $xyz=1$ obtenemos
\[
x=\pm \frac{1}{z}\sqrt{\frac{2z^2}{z^2-z^4\pm\sqrt{(z^4-z^2)^2-4z^2}}}=\pm \sqrt{\frac{2}{z^2-z^4\pm\sqrt{(z^4-z^2)^2-4z^2}}}
\]
\end{solucion}


\newpage

\begin{ejercicio}{3.1.9}
Consider the system of equations given by
\[x^5 +
\frac{1}
{x^5} = y,\]
\[x +
\frac{1}
{x}
= z.\]
Let $I$ be the ideal in $\C[x, y, z]$ determined by these equations.
\begin{enumerate}[a.]
\item Find a basis of $I_1 ⊆ \C[y, z]$ and show that $I_2 = \{0\}$.
\item Use the Extension Theorem to prove that each partial solution $c ∈ \V(I_2) = \C$ extends
to a solution in $\V(I) ⊆ \C^3$.
\item Which partial solutions $(b, c) ∈ \V(I_1) ⊆ \R^2$ extend to solutions in $\V(I) ⊆ \R^3$?
Explain why your answer does not contradict the Extension Theorem.
\item If we regard $z$ as a “parameter” (see the previous problem), then solve for $x$ and $y$ as
algebraic functions of $z$ to obtain a “parametrization” of $\V(I)$.
\end{enumerate}
\end{ejercicio}
\begin{solucion}
Como buscamos un ideal en $\C[x, y, z]$, teniendo en cuenta que $x\neq 0$, nuestro ideal sera 
\[
I=\gene{x^{10}-x^5y+1, x^2-xz+1}.
\]
\begin{enumerate}[a.]
\item Calculamos una base de Gröbner para $I$ con lex siendo $x>y>z$. 
\[
G=\{x^2 − xz + 1, y − z^5 + 5z^3 − 5z\}
\]
\item Ninguno de los polinomios depende solo de $z$ por lo que $I_2=\{0\}$. Por otro lado, $I_1$ tiene una base
\[
G_1=\{y−z^5+5z^3−5z\}
\]
 Como $I_2=\{0\}$, $\V(I_2)=\C$, luego podemos tomar cualquier $c\in\C$ como solución parcial. Como el coeficiente de $y$ en $G_1$ es 1, $c$ siempre se extiende a una solución parcial $(b,c)\in \V(I_1)$. Por último, el coeficiente de $x^2$ en $G$ es 1 luego por el mismo motivo siempre podemos extender $(b,c)$ a $(a,b,c)\in\V(I)$.  
 
 \item Dada una solución parcial $(y,z)\in\V(I_1)$, tenemos que $y=z^5-5z^3+5z$. En $G$, despejando $x$ en función de $z$ obtenemos
 \[
 x=\frac{z\pm \sqrt{z^2-4}}{2}
 \]
 Esta solución existe en $\R$ siempre que $z^2\geq 4\Leftrightarrow |z|\geq 2$. 
\item En el apartado anterior ya conseguimos esa parametrización.
\end{enumerate}
\end{solucion}


\end{document}
