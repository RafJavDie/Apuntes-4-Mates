\documentclass[ACGA.tex]{subfiles}

\begin{document}

\chapter{Multiplicidad y grado}

\section{Anillos y módulos graduados}
\begin{defi}
Un \textbf{anillo graduado} es un anillo $A$ con una descomposición 
\[ A = \bigoplus_{n=0}^{∞} A_n \]
como suma directa de subgrupos aditivos tal que:
\[ A_m \cdot A_n \subseteq A_{m+n} \]
Los elementos de $A_n$ se llaman homogéneos de grado $n$. De la definición se deduce que $A_0$ es un subanillo de $A$.
\end{defi}

\begin{ej}
$A = k[x_0,\dots,x_d]$ con $A_n = \{\text{polinomios de grado }n\}$.
\end{ej}

\begin{defi}
Si $A$ es un anillo graduado, un $A$-\textbf{módulo graduado} es un $A$-módulo $M$ dotado de una descomposición
\[ M = \bigoplus_{n≥0} M_n \]
tal que $A_m \cdot M_n \subseteq M_{m+n}$.
\end{defi}

\begin{defi}
Si $M$, $N$ son dos $A$-módulos gruadados, un homomorfismo $φ : M \to N$ de $A$-ḿodulos gruduados es un homomorfismo de $A$-módulos tal que
\[ φ(M_n) \subset N_n \quad \forall n ≥ 0 \]
\end{defi}

\begin{defi}
Sea $M$ un $A$-módulo graduado, $N \subseteq M$ es un $A$-\textbf{submódulo graduado} si
\[ N = \bigoplus_{n≥0} (M_i \cap N) \]
\end{defi}

\begin{teorema}
Sea $M$ un $A$-módulo graduado, $N \subseteq M$ un $A$-\textbf{submódulo graduado}. Entonces $M/N$ es un $A$-módulo graduado. 
\end{teorema}
\begin{dem}
Veamos
\[ M/N \cong \bigoplus_{i≥0} M_i / N_i \]
donde $N_i = M_i \cap N$. Primero observamos que $M_i/N_i \xrightarrow{ψ} M/N$ definido como $m + N_i \to m+N$. Si $ψ$ es isomorfismo, éste induce un isomorfismo $\bigoplus (M_i/N_i) \cong M/N$. Veamos que $ψ$ es isomorfismo. Supongamos que:
\[ ψ\left(\sum m_i + N_i\right) = 0 \Rightarrow  \sum \left(m_i + N\right) = 0 \Rightarrow  \left(\sum m_i\right) + N = 0\]
Entonces:
\[ \sum m_i \in N = \bigoplus N_i \]
Luego existen $n_i \in N_i$ tal que:
\[ \sum m_i = \sum n_i\]
Pero como $M = \bigoplus_{i≥0} M_i$, llegamos a que $m_i = n_i$, es decir $m_i \in N_i$, luego $m_i + N_i = 0$ para todo $i$. Esto implica la inyectividad.

Para ver la sobreyectividad tomamos $m+N \in M/N$ con $m \in M$. Entonces $m = \sum m_i$ con $m_i \in M_i$. Enonces $m+N = ψ\left(\sum m_i + N_i\right)$.
\end{dem}

\begin{ej}
Sea $A = k[x_0,\dots,x_n]$. Si $I \subseteq A$ es un ideal homogéneo, $I = \bigoplus_{r≥0} \left(I \cap A_r\right)$. luego $A/I$ es un $A$-módulo graduado.
\end{ej}

\begin{teorema}
Sea $A = k[x_0,\dots,x_n]$ y $M$ un $A$-módulo graduado finitamente generado con $M = \bigoplus_{r≥0} M_r$. Entonces para todo $r$, $M_r$ es un $k$-espacio vectorial de dimensión finita.
\end{teorema}
\begin{dem}
Como $M$ es finitamente generado, existen $g_1,\dots,g_s$ con $M = \langle g_1, \dots, g_s\rangle$.
Podemos suponer que $g_1,\dots,g_s$ son homogéneos, pues en caso contrario podemos obtener un nuevo sistema generador con sus componentes homogéneas. 
Dígamos que $g_i$ es de grado $d_i$ para todo $i=1,\dots,s$.

Sea $g \in M_r$, entonces $g = \sum_{i=1}^s a_i g_i$ con $a_i \in A$. Descomponiendo $a_i$ en sus componentes homogénas, y sabiendo que todas las componentes homogéneas de grado distinto de $r$ deben anularse para quedar en $M_r$ quiere decir que podemos tomar $b_i$ como la componentes de homogéneas de $\sum a_i$ de grado $r-d_i$ tal que $g = \sum_{i=1}^s b_i g_i$. Entonces:
hay un homomorfismo de $k$-espacio vectoriales sobreyectivo:
\[ \bigoplus_{i≥0} A_{r-d_i} \longrightarrow M_r \]
\[ (b_1,\dots,b_s) \mapsto \sum_{i=1}^s b_i g_i\]
Como $\bigoplus A_{r-d_i}$ es de dimensión finita, $M_r$ es de dimensión finita.
\end{dem}

\begin{defi}
Sea $M$ un $k[x_0,\dots,x_n]$-módulo graduado y finitamente generado. La \textbf{función de Hilbert} de $M$ es
\begin{align*}
	φ_M : & \N \longrightarrow \N \\
	& r \mapsto \dim_k (M_r)
\end{align*}
\end{defi}

\begin{ej}
Sea $M = k[x_0,\dots,x_n]$. Entonces $φ_M(r) = \dim_k k[x_0,\dots,x_n]_r = {{r+n} \choose n}$. Obsérvese que ${{r+n} \choose n}$ es un polinomio de grado $n$ en $r$ con coeficiente líder $r^n/n!$.
\end{ej}

\section{El polinomio de Hilbert de una variedad proyectiva}

Empezamos definiendo el análogo al anillo de coordenadas para una variedad proyectiva.

\begin{defi}
 Sea $X\subseteq\Pnk$ un conjunto algebraico proyectivo. El {\bf anillo de coordenadas homogéneo} de $X$ es el anillo cociente ${\mathcal S}(X):=k[x_0,x_1,\ldots,x_n]/\I(X)$.
\end{defi}

Como $\I(X)$ es un ideal homogéneo, la graduación natural de $k[x_0,x_1,\ldots,x_n]$ como suma directa de los subespacios $k[x_0,x_1,\ldots,x_n]_r$ formados por los polinomios homogéneos de grado $r$ para todo $r\geq 0$ induce una descomposición $\I(X)=\bigoplus_r\I(X)_r$ (donde $\I(X)_r=\I(X)\cap k[x_0,x_1,\ldots,x_n]_r$) y por tanto una graduación en ${\mathcal S}(X)$:
$$
{\mathcal S}(X)=\bigoplus_{r=0}^{\infty}{\mathcal S}_r(X)
$$
donde ${\mathcal S}_r(X)=k[x_0,x_1,\ldots,x_n]_r/\I(X)_r$ como $k$-espacio vectorial.

\begin{ejer}
 Probar que se tiene dicha descomposición para ${\mathcal S}(X)$.
\end{ejer}

Para todo $r\geq 0$, ${\mathcal S}_r(X)$ es un espacio vectorial de dimensión finita, por ser un cociente de $k[x_0,x_1,\ldots,x_n]_r$, que tiene dimensión ${{n+r}\choose n}$.

\begin{defi}
 Sea $X\subseteq\Pnk$ un conjunto algebraico proyectivo. La {\bf función de Hilbert} de $X$ es la función $\varphi_X:{\mathbb N}\to{\mathbb N}$ dada por
$$
\varphi_X(r)=\dim_k{\mathcal S}_r(X).
$$
\end{defi}

\begin{ejs}\label{hilbert}
\begin{enumerate}
        \item La función de Hilbert de $\Pnk$ viene dada por $$\varphi_{\Pnk}(r)={{r+n}\choose n}=\frac{1}{n!}(r+1)(r+2)\cdots(r+n)$$.
\item Sea $X\subseteq\PP^1_k$ un conjunto finito formado por $d$ puntos. Entonces $\I(X)$ está generado por un polinomio homogéneo reducido $f(x_0,x_1)$ de grado $d$. Para cada $r\geq 0$, $\I(X)_r$ sólo contiene al $0$ si $r<d$, y tiene dimensión $r-d+1$ si $r\geq d$ (ya que la aplicación lineal $k[x_0,x_1]_{r-d}\to\I(X)_r$ dada por $g\mapsto fg$ es un isomorfismo de espacios vectoriales). Por tanto ${\mathcal S}(X)_r$ tiene dimensión $r+1$ si $r<d$ y $r+1-(r-d+1)=d$ si $r\geq d$:
$$
\varphi_X(r)=\left\{\begin{array}{ll}
                     r+1 & \text{si }r<d \\
                     d & \text{si }r\geq d.
                    \end{array}\right.
$$

\end{enumerate}
\end{ejs}

Nuestro próximo objetivo es probar que la función de Hilbert coincide con un polinomio para valores grandes de la variable.

\begin{prop}\label{existepolinomio}
Sea $X\subseteq\Pnk$ un conjunto algebraico proyectivo no vacío. Existen un entero $r_0$ y un polinomio $P_X\in {\mathbb Q}[t]$ tal que $\varphi_X(r)=P_X(r)$ para todo $r\geq r_0$. Además, el grado de $P_X$ es la dimensión de $X$.
\end{prop}
También podemos formularla de la siguiente forma.
\begin{prop}
Sea $I\subseteq k[x_0,\dots, x_n]$ un ideal homogéneo. $\varphi_{A/I}(r)$ la función de Hilbert de $A/I$. Entonces exite $r_0$ y un polinomio $P_{A/I}\in\mathbb{Q}(t)$ único tal que $\varphi_{A/I}(r)=P_{A/I}(r)\ \forall r\geq r_0$. Además, si $\langle 1\rangle \neq\sqrt{I}\neq \langle x_0,\dots, x_r\rangle$, el grado de $P_{A/I}$ es la dimensión de $\V(I)$. 
\end{prop}

\begin{proof}
Sea $I=\I(X)$, es un ideal homogéneo propio de $A:=k[x_0,x_1,\ldots,x_n]$. Hay que probar que la función $\varphi_{\I(X)}(r)=\varphi_X(r)=\dim_k A_r/I_r$ coincide con un polinomio de grado $\dim X=\dim\V(I)$ para $r\geq r_0$. Lo probaremos en general para un ideal homogéneo arbitrario $I\subseteq A$ tal que $\V(I)\neq\emptyset$ (es decir, tal que $\langle x_0,x_1,\ldots,x_n\rangle\not\subseteq \sqrt{I}$).

 La prueba se hará por inducción en $n$. Para $n=0$, $I$ debe ser el ideal $\{0\}$. Entonces $k[x_0]/I=k[x_0]$, y $k[x_0]_r$ está generado por $x_0^r$ como espacio vectorial. La función de Hilbert en este caso es la constante $1$, y coincide con el polinomio $1$ de grado $0=\dim(X)$ para $r\geq 0$.

Supongámoslo probado para $n-1$ variables, con $n\geq 1$. Elijamos un polinomio lineal $H(x_0,x_1,\ldots,x_n)\in A_1$ tal que el hiperplano definido por $H=0$ no contenga a ninguna componente irreducible de ${\mathcal V}(I)$. Mediante un cambio lineal de variables, podemos suponer que $H=x_n$. La condición impuesta sobre $H$ implica que la multiplicación por $x_n$ es un homomorfismo inyectivo $A/I\to A/I$. Para probarlo basta ver que todo elemento homogéneo del núcleo es 0. Así, sea $f\in A/I$ homogéneo tal que $x_nf=0$, con lo que en particular $x_nf\equiv 0$ en todas las componentes irreducibles de $\V(I)$. Como $x_n$ no es idénticamente 0 en ninguna componente, lo tiene que ser $f$. El conúcleo es $(A/I)/x_n\cdot(A/I)=A/(\langle x_n\rangle +I)\cong B/J$, donde $B=k[x_0,\ldots,x_{n-1}]$ y $J=(\langle x_n\rangle +I)\cap B$. Obtenemos así una sucesión exacta
$$
0\to A/I\stackrel{x_n\cdot}{\to} A/I \to B/J\to 0.
$$
Tomando las componentes homogéneas de grado $r$ y teniendo en cuenta que multiplicar por $x_n$ aumenta en $1$ el grado (es, decir, la imagen se puede considerar $A/I(1)$), deducimos que $\varphi_I(r)-\varphi_I(r-1)=\varphi_J(r)$ para todo $r$.

Supongamos en primer lugar que $\langle x_0,x_1,\ldots,x_{n-1}\rangle_B\subseteq \sqrt{J}$. Entonces $J$ (y por consiguiente $\langle x_n\rangle +I$) contiene una potencia de $x_i$ para todo $i=0,\ldots,n-1$, así que $\langle x_0,x_1,\ldots,x_{n-1}\rangle_A\subseteq \sqrt{\langle x_n\rangle +I}$. Equivalentemente, $\V(\langle x_n\rangle +I)=\V(x_n)\cap\V(I)\subseteq\V(x_0,x_1,\ldots,x_{n-1})$. Como un punto de $\Pnk$ no puede tener todas sus coordenadas nulas, concluimos que $\V(x_n)\cap\V(I)=\emptyset$. Una variedad proyectiva de dimensión $>0$ corta a cualquier hiperplano (de lo contrario, sería isomorfa a una variedad afín, en contradicción con el corolario \ref{proyectivanoafin}). Por tanto toda componente irreducible de $\V(I)$ debe tener dimensión $0$.

Por otra parte, $B/J$ es un $k[x_0,x_1,\ldots,x_{n-1}]$-módulo finitamente generado que es anulado por una potencia de $x_i$ para todo $i=0,\ldots,n-1$. En particular es un $k$-espacio vectorial de dimensión finita, y por tanto $\varphi_J(r)$ sólo puede ser positivo para un número finito de $r$. Existe entonces un $r_0$ tal que $\varphi_J(r)=0$ para $r\geq r_0$, y por tanto $\varphi_I(r)-\varphi_I(r-1)=0$ para $r\geq r_0$. Así que $\varphi_I(r)$ es constante para $r\geq r_0$, y coincide con un polinomio de grado $0=\dim\V(I)$.

Supongamos ahora que $\langle x_0,x_1,\ldots,x_{n-1}\rangle_B\not\subseteq \sqrt{J}$. Por hipótesis de inducción, $\varphi_J(r)$ coincide con un polinomio $P_J\in{\mathbb Q}[t]$ para todo $r$ suficientemente grande. Además, el grado de $P_J$ es la dimensión de $\V(J)$ en $\PP^{n-1}_k$ o, equivalentemente, la dimensión de $\V(\langle x_n\rangle +I)=\V(x_n)\cap\V(I)$ en $\Pnk$. Por hipótesis, ninguna componente irreducible de $\V(I)$ está contenida en la hipersuperficie $x_n=0$, así que $\dim(\V(x_n)\cap\V(I))=\dim\V(I)-1$ por el ejercicio \ref{dimensionbaja1}. Por tanto el grado de $P_J$ es $\dim\V(I)-1$. Concluimos por el lema siguiente y su corolario.
\end{proof}

\begin{lemma}
 Sea $P\in{\mathbb Q}[t]$ un polinomio de grado $d$ tal que $P(r)\in{\mathbb Z}$ para todo $r\in{\mathbb Z}$ mayor o igual que un $r_0$ fijo. Entonces existen enteros $a_0,\ldots,a_d\in{\mathbb Z}$ tales que
$$
P(r)=a_d{r\choose d}+a_{d-1}{r\choose{d-1}}+\cdots+a_1{r\choose 1}+a_0.
$$
\end{lemma}

\begin{proof}
 Por inducción en $d$. Para $d=0$ es resultado es evidente. Supongámoslo probado para $d-1\geq 0$, y sea $P\in{\mathbb Q}[t]$ de grado $d$ cumpliendo la hipótesis. Entonces $Q(t):=P(t+1)-P(t)$ también verifica la hipótesis y tiene grado $d-1$, por tanto existen $b_0,\ldots,b_{d-1}\in{\mathbb Z}$ tales que 
$$
P(r+1)-P(r)=b_{d-1}{r\choose{d-1}}+\cdots+b_1{r\choose 1}+b_0.
$$
Sea
$$
R(r)=b_{d-1}{r\choose{d}}+\cdots+b_1{r\choose 2}+b_0{r\choose 1},
$$
entonces $R(j+1)-R(j)=P(j+1)-P(j)$ para todo $j$. Sumando desde $j=0$ hasta $r-1$, obtenemos $R(r)-R(0)=P(r)-P(0)$, es decir, $P(r)=R(r)+(P(0)-R(0))$. Basta entonces tomar $a_j=b_{j-1}$ para $j=1,\ldots,d$ y $a_0=P(0)-R(0)$.
\end{proof}



\begin{coro}\label{polinomiodiff}
 Sea $f:{\mathbb N}\to{\mathbb N}$ una función tal que existen un entero $r_0$ y un polinomio $Q\in{\mathbb Q}[t]$ de grado $d-1\geq 0$ con $f(r)-f(r-1)=Q(r)$ para todo $r\geq r_0$. Entonces existe un polinomio $P\in{\mathbb Q}[t]$ de grado $d$ tal que $f(r)=P(r)$ para $r> r_0$.
\end{coro}

\begin{proof} Por el lema, existen $c_0,\ldots,c_{d-1}\in{\mathbb Z}$ tales que
$$
f(r)-f(r-1)=c_{d-1}{r\choose{d-1}}+\cdots+c_1{r\choose 1}+c_0
$$
para $r\geq r_0$. Sea $R(r)=c_{d-1}{r\choose{d}}+\cdots+c_1{r\choose 2}+c_0{r\choose 1}$, entonces $R(j)-R(j-1)=f(j)-f(j-1)$ para $j\geq r_0$. Sumando desde $j=r_0+1$ hasta $r$, obtenemos $R(r)-R(r_0)=f(r)-f(r_0)$ para $r>r_0$. Es decir, $f(r)$ coincide con el polinomio $P(r):=R(r)+(f(r_0)-P(r_0))$ para $r>r_0$.
\end{proof}

\begin{defi}
 Sea $X\subseteq\Pnk$ un conjunto algebraico. El {\bf polinomio de Hilbert} de $X$ es el único polinomio $P_X\in{\mathbb Q}[t]$ tal que $\varphi_X(r)=P_X(r)$ para todo $r$ mayor o igual que un cierto $r_0$. Más generalmente, dado un ideal homogéneo $I\subseteq k[x_0,x_1,\ldots,x_n]$ tal que $\V(I)\neq\emptyset$, su {\bf polinomio de Hilbert} es el único polinomio $P_I\in{\mathbb Q}[t]$ tal que $\varphi_I(r)=P_I(r)$ para todo $r$ mayor o igual que un cierto $r_0$.
\end{defi}

\section{El grado de una variedad proyectiva}

\begin{defi}
 Sea $X\subseteq\Pnk$ un conjunto algebraico de dimensión $d$, y $P_X$ su polinomio de Hilbert. El {\bf grado} de $X$ es $d!$ multiplicado por el coeficiente del término de mayor grado de $P_X$ (coincide con el coeficiente que multiplica a $\binom{n}{d}$).
\end{defi}

\begin{prop}
Si $X=\V(f)$ con $f$ homogéneo de grado $d$ libre de cuadrados, $gr(X)=gr(f)$. 
\end{prop}

\begin{ejs}

\begin{enumerate}
        \item Sea $X=\Pnk$. Por \ref{hilbert}, el polinomio de Hilbert de $X$ es $\frac{1}{n!}(r+1)(r+2)\cdots(r+n)$. Su término de mayor grado es $\frac{r^n}{n!}$, y por tanto su grado es $\frac{n!}{n!}=1$.
\item Sea $X\subseteq\PP^1_k$ un conjunto finito formado por $d$ puntos. Por \ref{hilbert}, su polinomio de Hilbert es la constante $d$. Por tanto, su grado es $0!d=d$.

	\item Sea $f\in A_d$, consideramos $M=\langle f\rangle=\bigoplus_{r\geq 0}M_r$ con $M_r=A_r\cap M$. Entonces $\varphi_M(r)=\dim\{g\in\langle f\rangle\mid g$ homogéneo de grado $r\}$. Si $r<d$ claramente esta dimensión es 0. Para $r\geq d$ tomamos el isomorfismo $A_{r-d}\to M_r$ dado por $h\mapsto fh$ (es inyectivo por ser dominio de integridad). En ese caso, la dimensión es $\binom{n-d+r}{n}$, un polinomio en $r$ cuyo término líder es $\frac{r^n}{n!}$.

Vamos a hacer ahora el cociente $M=A/\langle f\rangle=\bigoplus_{r\geq 0} A_r/\langle f\rangle_r=\bigoplus_{r=0}^{d-1}A_r\oplus\bigoplus_{r\geq d}A_r/(A_{d-r}f)$.
Entonces 
\[
\varphi_M(r)=\begin{cases}
\binom{n+r}{n} & r<d\\
\binom{n+r}{n}-\binom{n-d+r}{n} & r\geq d
\end{cases}
\] 
En el segundo caso, el término de grado $n$ se cancela, por lo que hay que mirar los coeficientes de $r^{n-1}$. En este caso, a la izquierda es $\frac{(r+n)\cdots (r+1)}{n}$. Como tiene raíces desde $-1$ hasta $-n$, el coeficiente será $\frac{1+\dots+n}{n!}$ (arriba suma de - las raíces). Análogamente, en la derecha el coeficiente de $r^{n-1}$ será $\frac{1+\dots+n-nd}{n!}$. Al hacer la diferencia queda $\frac{d}{(n-1)!}r^{n-1}$
\end{enumerate}

\end{ejs}

\begin{prop}\label{gradointerseccion}
 Sea $X\subseteq\Pnk$ un conjunto algebraico proyectivo de grado $d$ y $H=\V(f)\subseteq\Pnk$ una hipersuperficie definida por un polinomio homogéneo de grado $e$ que no contenga a ninguna componente irreducible de $X$. Supongamos que el ideal $\I(X)+\langle f\rangle$ es radical. Entonces el grado de $X\cap H$ es igual a $de$.
\end{prop}

\begin{proof}
 Como $\I(X)+\langle f\rangle$ es radical, $\I(X\cap H)=\I(\V(\I(X)+\langle f\rangle))=\I(X)+\langle f\rangle$. Al igual que en la prueba de la proposición \ref{existepolinomio}, como $H$ no contiene ninguna componente irreducible de $X$ la multiplicación por $f$ es un homomorfismo inyectivo $A/\I(X)\to A/\I(X)$ por \cite[Proposición 4.7]{am}. Obtenemos así una sucesión exacta
$$
0\to A/\I(X)\stackrel{f \cdot}{\to} A/\I(X) \to A/(\I(X)+\langle f\rangle)=A/\I(X\cap H)\to 0.
$$
Comparando las componentes homogéneas de grado $r$ y teniendo en cuenta que la multiplicación por $f$ aumenta el grado en $e$, concluimos que $\varphi_{X\cap H}(r)=\varphi_X(r)-\varphi_X(r-e)$ para $r\geq e$. Por tanto $P_{X\cap H}(r)=P_X(r)-P_X(r-e)$. Si $m=\dim(X)$, el término de mayor grado de $P_X(r)$ es $d\frac{r^m}{m!}$, así que el término de mayor grado de $P_{X\cap H}(r)=P_X(r)-P_X(r-e)$ es $\frac{dmr^{m-1}e}{m!}=de\frac{r^{m-1}}{(m-1)!}$. El grado de $X\cap H$ es entonces $de$ por definición. 
\end{proof}

\begin{ejs}
 \emph{La hipótesis de que $\I(X)+\langle f\rangle$ sea radical es fundamental: sea $X=\V(x_0x_1-x_2^2)\subseteq\PP^2_\C$, y $H=\V(x_0)$. Entonces $X$ tiene grado $2$ (ejercicio \ref{gradohipersuperficie}) pero $X\cap H=\{(0:1:0)\}$ tiene grado $1$. En este caso, $\I(X)+\langle x_0\rangle=\langle x_0,x_2^2\rangle$ no es radical.}

\emph{En general, es necesario considerar no sólo el grado de $X\cap H$, sino también la \emph{multiplicidad} de cada una de sus componentes irreducibles. En estas notas nos limitaremos al caso de multiplicidad $1$ (es decir, $\I(X)+\langle f\rangle$ radical).}
\end{ejs}

El conjunto de hiperplanos en $\Pnk$ puede dotarse de una estructura de espacio proyectivo (el espacio dual de $\Pnk$). Se puede probar que, si $X$ es una variedad, el conjunto de hiperplanos $H=\V(f)$ tales que $X\not\subseteq H$, $\I(X)+\langle f\rangle$ es radical y (si $m\geq 2$) $X\cap H$ es irreducible contiene un abierto denso en dicho espacio proyectivo. Supongamos que $X$ tiene dimensión $m$ y grado $d$. Repitiendo el proceso $m$ veces, deducimos que para la ``mayoría'' (en un cierto sentido que no definiremos aquí) de subvariedades lineales $L=\langle f_1,\ldots,f_m\rangle$ de $\Pnk$ de dimensión $n-m$, $X\cap L$ tiene dimensión $0$ (es decir, es un conjunto finito de puntos) y ideal $\I(X)+\langle f_1,\ldots,f_m\rangle$ es radical. Por la proposición \ref{gradointerseccion} tenemos entonces que el grado de $X\cap L$ es $d$, y por tanto es un conjunto de $d$ puntos (ejercicio \ref{gradoconjuntofinito}).

Vemos así que el grado de una variedad $X\subseteq\Pnk$ de dimensión $m$ es el número de puntos de intersección de $X$ con una subvariedad lineal de $\Pnk$ de dimensión $n-m$ suficientemente general. 

\begin{ejs}
El polinomio de Hilbert (y por tanto el grado) no es una propiedad intrínseca de la variedad. Sea $A=\V(x_0)\cong \V(x_0^2+x_1^2+x_2^2)=B$ en $\mathbb{P}^2$. Entonces $P_A(t)=\binom{t+2}{2}-\binom{t+1}{2}=t+1$ y $P_B(t)=\binom{t+2}{2}-\binom{t}{2}=2t+1$. 
\end{ejs}

\section[Multiplicidad de intersección]{Multiplicidad de intersección. El teorema de Bézout}

                                                                                                                                                                                                                                                                                                                                                                                        Sean $X=\V(f)$ e $Y=\V(g)$ dos curvas en $\PP^2_k$, donde $f,g\in k[x_0,x_1,x_2]$ son polinomios homogéneos irreducibles. Por el ejercicio \ref{interseccionnovacia}, su intersección $X\cap Y$ es no vacía. 

\begin{defi}
 Se dice que $X$ e $Y$ están en {\bf posición general} si su intersección tiene dimensión $0$ (es decir, es un conjunto finito de puntos).
\end{defi}

\begin{ejer}
 Probar que dos curvas están en posición general si y sólo si no tienen ninguna componente irreducible en común.
\end{ejer}

Sea $a\in X\cap Y$. Si el grado de $f$ es $d$, dado cualquier $h\in k[x_0,x_1,x_2]$ homogéneo de grado $d$ que no se anule en $a$ la función racional $f/h$ está definida en $a$, y por tanto pertenece a ${\mathcal O}_{\PP^2_k,a}$. Además, el ideal generado por $f/h$ en ${\mathcal O}_{\PP^2_k,x}$ sólo depende de $f$, ya que si elegimos otro $h'$ homogéneo de grado $d$ que no se anule en $a$, las funciones ${f}/{h}$ y ${f}/{h'}$ difieren en una unidad. Por abuso de lenguaje, lo llamaremos simplemente el ideal de ${\mathcal O}_{\PP^2_k,a}$ generado por $f$. Consideremos el anillo local ${\mathcal O}_{\PP^2_k,a}/\langle f,g\rangle$. Como $a$ es un punto aislado en la intersección de $X$ e $Y$, el radical del ideal $\langle f,g\rangle$ de ${\mathcal O}_{\PP^2_k,a}$ es su ideal maximal o, equivalentemente, el ideal maximal de  su ideal maximal de ${\mathcal O}_{\PP^2_k,a}/\langle f,g\rangle$ es nilpotente, y por tanto el anillo ${\mathcal O}_{\PP^2_k,a}/\langle f,g\rangle$ es un $k$-espacio vectorial de dimensión finita. 

\begin{defi}
 Sean $X,Y\subseteq\PP^2_k$ dos curvas en posición general y $a\in X\cap Y$. La {\bf multiplicidad de intersección} de $X$ e $Y$ en $a$ es la dimensión de ${\mathcal O}_{\PP^2_k,a}/\langle f,g\rangle$ como espacio vectorial sobre $k$.
\end{defi}

\begin{observaciones}

La dimensión siempre es finita porque $\V(f)\cap\V(g)$ tiene dimensión finita (por un ejercicio).
\end{observaciones}
 
\begin{prop}
 Sean $X=\V(f)$ e $Y=\V(g)\subseteq\PP^2_k$ dos curvas en posición general, con $X\cap Y=\{P_1,\ldots,P_r\}$. Sea $\mu_i$ la multiplicidad de intersección de $X$ e $Y$ en $P_i$ para $i=1,\ldots,r$. El polinomio de Hilbert del ideal $I=\langle f,g\rangle$ (que es constante, ya que $\dim\V(I)=0$) es $\mu_1+\cdots+\mu_r$. 
\end{prop}

\begin{proof}
 Sea $H$ una recta que no contenga a ninguno de los puntos $P_1,\ldots,P_r$. Mediante un cambio lineal de variables, podemos suponer que $H$ es la recta $x_0=0$. Entonces todos los $P_i$ están en $\A^2_k\subseteq\PP^2_k$. Es decir, el ideal $\langle x_0,f,g \rangle$ define el conjunto vacío y por tanto su radical es $\langle x_0,x_1,x_2\rangle$. En particular, este ideal contiene a todo polinomio homogéneo de grado mayor o igual que un cierto $d_0$ o, dicho de otra forma, $I_d+x_0\cdot A_{d-1}=A_d$ para todo $d\geq d_0$, donde $A_d=k[x_0,x_1,x_2]_d$. Entonces el homomorfismo de espacios vectoriales $A_{d}/I_{d}\to A_{d+1}/I_{d+1}$ dado por la multiplicación por $x_0$ es sobreyectivo para $d\geq d_0$.

Por otra parte, sabemos que la dimensión de $A_d/I_d$ es constante para $d$ mayor o igual a un cierto $d_1$, ya que el polinomio de Hilbert tiene grado $0$. Por tanto, la multiplicación por $x_0$ induce un isomorfismo $A_{d}/I_{d}\to A_{d+1}/I_{d+1}$ para $d\geq\sup\{d_0,d_1\}$, y más generalmente la multiplicación por $x_0^e$ induce un isomorfismo $A_d/I_d\to A_{d+e}/I_{d+e}$ para $e\geq 0$.

Sea $d\geq\sup\{d_0,d_1\}$, y sea $\phi:k[x_0,x_1,x_2]_d\to k[x_1,x_2]$ el homomorfismo de deshomogeneización que lleva un polinomio $f(x_0,x_1,x_2)$ homogéneo de grado $d$ en $f(1,x_1,x_2)$. Como $\phi(I_d)\subseteq J$ (donde $J$ es el deshomogeneizado de $I$), obtenemos un homomorfismo de $k$-espacios vectoriales
$$
\phi:A_d/I_d\to k[x_1,x_2]/J.
$$
Veamos que $\phi$ es inyectivo: dado $F\in A_d$ tal que su deshomogeneizado esté en $J$, debe existir un $e\geq 0$ tal que $x_0^eF\in I_{d+e}$ (por el ejercicio \ref{homodeshomo}). Pero sabemos que la multiplicación por $x_0^e$ induce un isomorfismo $A_d/I_d\to A_{d+e}/I_{d+e}$, en particular $F$ debe estar en $I_d$.

Veamos ahora que $\phi$ es sobreyectivo para $d$ suficientemente grande. Como $k[x_1,x_2]/J$ tiene dimensión finita, está generado como $k$-espacio vectorial por un número finito de polinomios. Si $d$ es mayor que todos sus grados, cada uno de ellos será el deshomogeneizado de un polinomio homogéneo de grado $d$ (multiplicando sus homogeneizados por la potencia conveniente de $x_0$). Por tanto $\phi$ es sobreyectiva para dicho $d$. Concluimos que la dimensión de $A_d/I_d$ para $d$ suficientemente grande (y en particular el polinomio de Hilbert de $I$) coincide con la dimensión de $A:=k[x_1,x_2]/J$ como $k$-espacio vectorial.

Denotemos por $A_i$ al localizado de $A$ en el ideal ${\mathfrak m}_i$ maximal correspondiente a $P_i$, y consideremos el homomorfismo natural
$$
\Psi:A\to\bigoplus_{i=1}^{r} A_i.
$$
Como localizar conmuta con tomar cocientes, la dimensión como $k$-espacio vectorial de $A_i$ es justamente $\mu_i$. Por tanto, basta probar que $\Psi$ es un isomorfismo.

Elijamos un entero $s$ tal que $({\mathfrak m}_i^s)A_i=0$ para todo $i$ (que debe existir por estar $f$ y $g$ en posición general, $\sqrt{\langle f,g\rangle} \cdot k[x,y]_{m_i}=m_ik_[x,y]_{m_i}$ aplicando el Nullstellensatz). Notemos que $({\mathfrak m}_1^s\cap\cdots\cap{\mathfrak m}_r^s=0$ en $A$, ya que se anula al localizar en todos los ideales maximales) y que estos ideales son coprimos entre sí($m_i+m_j=B$ -el total- si $i\neq j$, podemos escribir el 1 como suma de elementos de cada ideal, ya que sabemos que se puede escoger una función regular que valga 1 en el punto $P_i$ y que se anule en los demás. De todas formas todos los ideales maximales son primos entre sí) ,  por lo que se tiene un isomorfismo $A\cong\oplus_{i=1}^r A/{\mathfrak m}_i^s$.

Como $A_i/{\mathfrak m}_j^s=0$ para $i\neq j$ (porque si existe una función que se anula en uno y es unidad en otro, pero si es unidad en el de abajo, el cociente es trivial), el resultado entonces se reduce a probar que el homomorfismo natural
$$
\Psi:A/{\mathfrak m}_i^s\to A_i/{\mathfrak m}_i^s
$$
es un isomorfismo para todo $i=1,\ldots,r$. Para ello, notemos que todo elemento de $A/{\mathfrak m}_i^s$ que no esté en ${\mathfrak m}_i$ es una unidad (por ser suma de una unidad (constante no nula) y un nilpotente), por lo que la localización en ${\mathfrak m}_i$ es un isomorfismo.
\end{proof}
\begin{teorema}[\bf de Bézout]
Sean $X$ e $Y\subseteq\PP^2_k$ dos curvas en posición general (no tienen ninguna componente irreducible en común, es decir, su intersección es un conjunto finito de puntos) de grados $d$ y $e$ respectivamente. Entonces la suma de las multiplicidades de los puntos de intersección de $X$ e $Y$ es $de$.
\end{teorema}

\begin{proof}
 Sean $A=k[x_0,x_1,x_2]$, y $f$ y $g$ generadores de $\I(X)$ e $\I(Y)$ respectivamente (son ideales principales por la proposición \ref{principalproy} aplicada a sus componentes irreducibles). La multiplicación por $g$ induce un homomorfismo inyectivo $A/\langle f\rangle\to A/\langle f\rangle$, ya que $f$ y $g$ no tienen factores comunes (de lo contrario $X$ e $Y$ tendrían una componente irreducible en común y no estarían en posición general). Obtenemos así una sucesión exacta
$$
0\to A/\langle f\rangle\stackrel{g\cdot}{\to} A/\langle f\rangle\to A/\langle f,g\rangle\to 0.
$$
Comparando las componentes homogéneas de grado $r$, deducimos que el polinomio de Hilbert de $\langle f,g\rangle$ es $P_X(r)-P_X(r-e)$, ya que multiplicar por $g$ aumenta el grado en $e$. Como $P_X$ tiene grado $1$ y su término de mayor grado es $dr$, concluimos que $P_{\langle f,g\rangle}(r)=de$. Comparando con el resultado obtenido en la proposición anterior se obtiene que $de$ es la suma de las multiplicidades de los puntos de intersección de $X$ e $Y$. 
\end{proof}

El resultado es válido más generalmente en dimensión $n$, si consideramos $n$ hipersuperficies $X_1,\ldots,X_n$ en posición general (es decir, tales que su intersección tenga dimensión $0$).

\begin{observaciones}
Si una de las curvas es $y=0$, entonces el teorema de Bézout es el teorema fundamental del álgebra.

Localizar conmuta con tomar cociente.

Si dos ideales son coprimos, cualquier potencia de uno es coprimo a cualquier potencia de otro (si se puede escribir el 1 como suma, es cuestión de elevar)

\end{observaciones}

\end{document}
